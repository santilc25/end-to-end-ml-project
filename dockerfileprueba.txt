FROM python:3.8-alpine

RUN apk --no-cache add git
RUN git clone https://github.com/santilc25/end-to-end-ml-project.git /app

WORKDIR /app

RUN apk --no-cache add curl && \
    apk add --no-cache --virtual .build-deps \
    openssl-dev \
    libffi-dev \
    musl-dev \
    gcc \
    make
RUN curl -sSL https://install.python-poetry.org | python3 - --version 1.4.2
ENV PATH="/root/.local/bin:$PATH"
RUN poetry config virtualenvs.create false && poetry install

CMD ["python", "app.py"]